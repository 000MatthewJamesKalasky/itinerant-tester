group: travis_latest
dist: xenial  # This should NOT be needed anymore
language: python
cache: pip
python:
  #- 2.7
  #- 3.5
  #- 3.6
  - 3.7
matrix:
  allow_failures:
    - python: 2.7
    - python: nightly
    - python: pypy
    - python: pypy3
env:
  - REPO=googleapis/api-client-staging  # 2019-07-10
  - REPO=googleapis/api-common-protos  # 2019-07-15
  - REPO=googleapis/artman            # 2019-07-19
  - REPO=googleapis/cloud-debug-nodejs  # 2019-07-15
  - REPO=googleapis/cloud-profiler-nodejs  # 2019-07-21
  - REPO=googleapis/cloud-trace-nodejs  # 2019-07-18
  - REPO=googleapis/cpp-cmakefiles    # 2019-07-18
  - REPO=googleapis/dialogflow-python-client-v2  # 2019-06-12
  - REPO=googleapis/discovery-artifact-manager  # 2019-07-20
  - REPO=googleapis/docuploader       # 2019-06-18
  - REPO=googleapis/elixir-google-api  # 2019-07-20
  - REPO=googleapis/gapic-generator   # 2019-07-19
  - REPO=googleapis/gapic-generator-cpp  # 2019-06-10
  - REPO=googleapis/gapic-generator-python  # 2019-07-19
  - REPO=googleapis/gax-java          # 2019-07-19
  - REPO=googleapis/gax-nodejs        # 2019-07-19
  - REPO=googleapis/gax-python        # archived
  - REPO=googleapis/gaxios            # 2019-07-21
  - REPO=googleapis/gce-images        # 2019-06-28
  - REPO=googleapis/gcp-metadata      # 2019-06-28
  - REPO=googleapis/gcs-resumable-upload  # 2019-07-17
  - REPO=googleapis/github-repo-automation  # 2019-07-15
  - REPO=googleapis/google-api-dotnet-client  # 2019-07-18
  - REPO=googleapis/google-api-java-client-services  # 2019-07-21
  - REPO=googleapis/google-api-nodejs-client  # 2019-07-20
  - REPO=googleapis/google-api-python-client  # 2019-07-17
  - REPO=googleapis/google-auth-library-nodejs  # 2019-07-21
  - REPO=googleapis/google-auth-library-python  # 2019-07-16
  - REPO=googleapis/google-auth-library-python-oauthlib  # 2019-06-24
  - REPO=googleapis/google-cloud-cpp  # 2019-07-21
  - REPO=googleapis/google-cloud-cpp-spanner  # 2019-07-19
  - REPO=googleapis/google-cloud-dotnet  # 2019-07-20
  - REPO=googleapis/google-cloud-go   # 2019-07-18
  - REPO=googleapis/google-cloud-java  # 2019-07-20
  - REPO=googleapis/google-cloud-kvstore  # 2019-06-28
  - REPO=googleapis/google-cloud-php  # 2019-07-19
  - REPO=googleapis/google-cloud-php-asset  # 2019-06-10
  - REPO=googleapis/google-cloud-php-automl  # 2019-05-23
  - REPO=googleapis/google-cloud-php-bigquerydatatransfer  # 2019-06-27
  - REPO=googleapis/google-cloud-php-bigtable  # 2019-06-27
  - REPO=googleapis/google-cloud-php-container  # 2019-06-27
  - REPO=googleapis/google-cloud-php-dataproc  # 2019-06-03
  - REPO=googleapis/google-cloud-php-datastore  # 2019-06-10
  - REPO=googleapis/google-cloud-php-debugger  # 2019-06-10
  - REPO=googleapis/google-cloud-php-dialogflow  # 2019-06-10
  - REPO=googleapis/google-cloud-php-dlp  # 2019-06-27
  - REPO=googleapis/google-cloud-php-errorreporting  # 2019-06-10
  - REPO=googleapis/google-cloud-php-firestore  # 2019-06-10
  - REPO=googleapis/google-cloud-php-iot  # 2019-06-10
  - REPO=googleapis/google-cloud-php-kms  # 2019-06-27
  - REPO=googleapis/google-cloud-php-language  # 2019-06-27
  - REPO=googleapis/google-cloud-php-logging  # 2019-06-10
  - REPO=googleapis/google-cloud-php-monitoring  # 2019-06-27
  - REPO=googleapis/google-cloud-php-oslogin  # 2019-06-10
  - REPO=googleapis/google-cloud-php-pubsub  # 2019-06-10
  - REPO=googleapis/google-cloud-php-redis  # 2019-06-27
  - REPO=googleapis/google-cloud-php-scheduler  # 2019-05-15
  - REPO=googleapis/google-cloud-php-security-center  # 2019-04-16
  - REPO=googleapis/google-cloud-php-spanner  # 2019-06-27
  - REPO=googleapis/google-cloud-php-speech  # 2019-06-27
  - REPO=googleapis/google-cloud-php-talent  # 2019-05-09
  - REPO=googleapis/google-cloud-php-tasks  # 2019-06-10
  - REPO=googleapis/google-cloud-php-text-to-speech  # 2019-06-10
  - REPO=googleapis/google-cloud-php-trace  # 2019-06-10
  - REPO=googleapis/google-cloud-php-videointelligence  # 2019-06-27
  - REPO=googleapis/google-cloud-php-vision  # 2019-06-10
  - REPO=googleapis/google-cloud-php-web-risk  # 2019-04-16
  - REPO=googleapis/google-cloud-php-web-security-scanner  # 2019-05-23
  - REPO=googleapis/google-cloud-python  # 2019-07-20
  - REPO=googleapis/google-cloud-python-happybase  # 2019-06-03
  - REPO=googleapis/google-cloud-ruby  # 2019-07-20
  - REPO=googleapis/google-p12-pem    # 2019-06-28
  - REPO=googleapis/google-resumable-media-python  # 2019-07-10
  - REPO=googleapis/googleapis        # 2019-07-19
  - REPO=googleapis/oauth2client      # 2019-02-08
  - REPO=googleapis/packman           # archived
  - REPO=googleapis/proto-plus-python  # 2019-06-05
  - REPO=googleapis/protoc-docs-plugin  # 2019-07-10
  - REPO=googleapis/protoc-java-resource-names-plugin  # 2019-05-31
  - REPO=googleapis/python-crc32c     # 2019-01-18
  - REPO=googleapis/python-ndb        # 2019-07-19
  - REPO=googleapis/release-please    # 2019-07-17
  - REPO=googleapis/releasetool       # 2019-07-12
  - REPO=googleapis/sample-tester     # 2019-07-16
  - REPO=googleapis/sloth             # 2019-07-17
  - REPO=googleapis/synthtool         # 2019-07-16
  - REPO=googleapis/teeny-request     # 2019-07-19

install:
  #- pip install -r requirements.txt
  - pip install flake8  # pytest  # add other testing frameworks later
before_script:
  - URL=https://github.com/${REPO}
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - git clone --depth=50 ${URL} ~/${REPO}  # --branch=master
  - cd ~/${REPO}
script:
  - echo stop the build if there are Python syntax errors or undefined names
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - time flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
  - echo exit-zero treats all errors as warnings.  The GitHub editor is 127 chars wide
  - time flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
  #- true  # pytest --capture=sys
notifications:
  on_success: change
  on_failure: change  # `always` will be the setting once code changes slow down
