group: travis_latest
os: linux
dist: focal
language: python
cache: pip
python:
  #- 2.7
  #- 3.5
  #- 3.6
  #- 3.7
  - 3.8
jobs:
  allow_failures:
    - python: 2.7
    - python: nightly
    - python: pypy
    - python: pypy3
env:
  - REPO=apple/apple-llvm-infrastructure-tools  # 2020-05-28
  - REPO=apple/ccs-caldavclientlibrary  # 2017-03-06
  - REPO=apple/ccs-caldavtester       # 2019-02-25
  - REPO=apple/ccs-pycalendar         # 2019-05-21
  - REPO=apple/ccs-pykerberos         # 2020-06-24
  - REPO=apple/ccs-pyopendirectory    # 2018-11-03
  - REPO=apple/ccs-pyosxframeworks    # 2017-02-27
  - REPO=apple/ccs-pysecuretransport  # 2017-02-27
  - REPO=apple/ccs-twistedextensions  # 2019-05-08
  - REPO=apple/coremltools            # 2020-06-26
  - REPO=apple/darwin-libpthread      # 2018-12-11
  - REPO=apple/darwin-xnu             # 2020-05-14
  - REPO=apple/foundationdb           # 2020-06-26
  - REPO=apple/indexstore-db          # 2020-06-25
  - REPO=apple/llvm-project           # 2020-06-26 llvm/llvm-project
  - REPO=llvm/llvm-project
  - REPO=apple/ml-afv                 # 2019-12-03
  - REPO=apple/ml-all-pairs           # 2019-03-30
  - REPO=apple/ml-capsules-inverted-attention-routing  # 2020-02-13
  - REPO=apple/ml-cifar-10-faster     # 2019-12-12
  - REPO=apple/ml-cvpr2019-swd        # 2020-02-10
  - REPO=apple/ml-data-parameters     # 2019-12-11
  - REPO=apple/ml-multiple-futures-prediction  # 2020-05-15
  - REPO=apple/ml-ncg                 # 2019-05-22
  - REPO=apple/ml-quant               # 2020-06-16
  - REPO=apple/sourcekit-lsp          # 2020-06-25
  - REPO=apple/swift                  # 2020-06-26
  - REPO=apple/swift-cmark            # 2020-06-25 commonmark/cmark
  - REPO=commonmark/cmark
  - REPO=apple/swift-corelibs-foundation  # 2020-06-26
  - REPO=apple/swift-corelibs-xctest  # 2020-06-25
  - REPO=apple/swift-crypto           # 2020-06-22
  - REPO=apple/swift-docker           # 2020-06-13
  - REPO=apple/swift-driver           # 2020-06-25
  - REPO=apple/swift-format           # 2020-06-24
  - REPO=apple/swift-integration-tests  # 2020-06-25
  - REPO=apple/swift-llbuild          # 2020-06-25
  - REPO=apple/swift-nio              # 2020-06-26
  - REPO=apple/swift-nio-http2        # 2020-06-18
  - REPO=apple/swift-nio-ssl          # 2020-06-16
  - REPO=apple/swift-package-manager  # 2020-06-26
  - REPO=apple/swift-protobuf         # 2020-06-25
  - REPO=apple/swift-se-0282-experimental  # 2020-06-12
  - REPO=apple/swift-source-compat-suite  # 2020-06-24
  - REPO=apple/swift-stress-tester    # 2020-06-25
  - REPO=apple/swift-syntax           # 2020-06-25
  - REPO=apple/swift-tools-support-core  # 2020-06-26
  - REPO=apple/swift-xcode-playground-support  # 2020-06-25
  - REPO=apple/turicreate             # 2020-06-26

install:
  #- pip install -r requirements.txt
  - pip install codespell flake8  # pytest  # add other testing frameworks later
before_script:
  - URL=https://github.com/${REPO}
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - git clone --depth=50 ${URL} ~/${REPO}  # --branch=master
  - cd ~/${REPO}
script:
  - echo stop the build if there are Python syntax errors or undefined names
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - time flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
  - echo exit-zero treats all errors as warnings.  The GitHub editor is 127 chars wide
  - flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
  - codespell . --ignore-words-list=ba,referer --skip=./.* --quiet-level=2 || true
  #- true  # pytest --capture=sys
notifications:
  on_success: change
  on_failure: change  # `always` will be the setting once code changes slow down
