group: travis_latest
os: linux
dist: focal
language: python
cache: pip
python:
  #- 2.7
  #- 3.5
  #- 3.6
  #- 3.7
  - 3.8
jobs:
  allow_failures:
    - python: 2.7
    - python: nightly
    - python: pypy
    - python: pypy3
env:
  - REPO=ThreatResponse/aws_ir        # 2020-06-26
  - REPO=ThreatResponse/aws_ir-api    # 2017-03-06
  - REPO=ThreatResponse/aws_ir_plugins  # 2018-07-07
  - REPO=ThreatResponse/bad-repo      # 2017-07-26
  - REPO=ThreatResponse/defense-against-the-dark-arts  # 2016-09-07
  - REPO=ThreatResponse/federated_access_proxy  # 2017-11-12 mozilla-iam/federated_access_proxy
  - REPO=mozilla-iam/federated_access_proxy
  - REPO=ThreatResponse/mad-king      # 2016-09-18
  - REPO=ThreatResponse/margaritashotgun  # 2020-06-26
  - REPO=ThreatResponse/poor-webhook  # 2017-07-15
  - REPO=ThreatResponse/python-lambda-inspector  # 2017-07-26
  - REPO=ThreatResponse/serverless-observatory  # 2017-05-30
  - REPO=ThreatResponse/serverless-showdown-api  # 2017-03-26
  - REPO=ThreatResponse/ssm-acquire   # 2018-11-27 andrewkrug/ssm-acquire
  - REPO=andrewkrug/ssm-acquire
  - REPO=ThreatResponse/ThreatPrep    # 2018-11-15
  - REPO=ThreatResponse/threatresponse_web  # 2016-08-04
  - REPO=ThreatResponse/timesketch    # 2016-07-12 google/timesketch
  - REPO=google/timesketch
  - REPO=pinterest/bazel              # 2018-10-31 bazelbuild/bazel
  - REPO=bazelbuild/bazel
  - REPO=pinterest/elixir-thrift      # 2020-06-01
  - REPO=pinterest/git-stacktrace     # 2019-11-21
  - REPO=pinterest/it-cpe-cookbooks   # 2020-05-21
  - REPO=pinterest/ktlint             # 2020-06-26
  - REPO=pinterest/pinrepo            # 2015-09-11
  - REPO=pinterest/plank              # 2020-05-27
  - REPO=pinterest/PodToBUILD         # 2020-05-27
  - REPO=pinterest/ptracer            # 2018-03-01
  - REPO=pinterest/pymemcache         # 2020-06-20
  - REPO=pinterest/rocksplicator      # 2020-06-26
  - REPO=pinterest/singer             # 2020-06-10
  - REPO=pinterest/snappass           # 2020-05-20
  - REPO=pinterest/teletraan          # 2020-06-25
  - REPO=pinterest/thrift-tools       # 2019-08-28
  - REPO=pinterest/tulsi              # 2020-06-18 bazelbuild/tulsi
  - REPO=bazelbuild/tulsi
  - REPO=pinterest/urlnorm            # 2019-04-29 jehiah/urlnorm
  - REPO=jehiah/urlnorm
  - REPO=pinterest/wheeljack          # 2018-10-23
  - REPO=pinterest/xchammer           # 2020-06-19
install:
  #- pip install -r requirements.txt
  - pip install codespell flake8  # pytest  # add other testing frameworks later
before_script:
  - URL=https://github.com/${REPO}
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - git clone --depth=50 ${URL} ~/${REPO}  # --branch=master
  - cd ~/${REPO}
script:
  - echo stop the build if there are Python syntax errors or undefined names
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - time flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
  - echo exit-zero treats all errors as warnings.  The GitHub editor is 127 chars wide
  - flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
  - codespell . --ignore-words-list=ba,referer --skip=./.* --quiet-level=2 || true
  #- true  # pytest --capture=sys
notifications:
  on_success: change
  on_failure: change  # `always` will be the setting once code changes slow down
