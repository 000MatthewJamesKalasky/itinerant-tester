group: travis_latest
os: linux
dist: bionic
language: python
cache: pip
python:
  #- 2.7
  #- 3.5
  #- 3.6
  #- 3.7
  - 3.8
jobs:
  allow_failures:
    - python: 2.7
    - python: nightly
    - python: pypy
    - python: pypy3
env:
  - REPO=adafruit/Adafruit_CircuitPython_CircuitPlayground
  - REPO=brettcannon/advent2018       # 2018-12-15
  - REPO=ansible/ansible
  - REPO=asyncio-docs/asyncio-doc
  - REPO=Azure/autorest
  - REPO=Azure/azure-cli
  - REPO=Azure/azure-functions-python-library
  - REPO=Azure/azure-kusto-python
  - REPO=Azure-Samples/Azure-MachineLearning-DataScience
  - REPO=Azure/azure-sdk-for-python
  - REPO=python/bedevere
  - REPO=psf/black
  - REPO=pypa/browntruck
  - REPO=brettcannon/caniusepython3   # 2019-12-24
  - REPO=conda/conda
  - REPO=conda/conda-docs
  - REPO=cookiecutter/cookiecutter
  - REPO=python/core-workflow
  - REPO=python/cpython
  - REPO=orsenthil/cpython-hg-to-git
  - REPO=pablogsal/cpython_leaderboard
  - REPO=dabeaz/curio
  - REPO=python/devguide
  - REPO=python/devinabox
  - REPO=django/django
  - REPO=kurtmckee/feedparser
  - REPO=takluyver/flit
  - REPO=brettcannon/free-labour      # 2020-02-05
  - REPO=brettcannon/gidgethub        # 2020-03-28
  - REPO=Mariatta/github-bot-tutorial
  - REPO=davidhalter/jedi
  - REPO=JuliaLang/julia
  - REPO=beeware/liquid-demo
  - REPO=MagicStack/MagicPython
  - REPO=microsoftarchive/msgraph-sdk-python
  - REPO=Azure/msrest-for-python
  - REPO=Azure/msrestazure-for-python
  - REPO=oauthlib/oauthlib
  - REPO=pypa/packaging
  - REPO=python/peps
  - REPO=python/pyperformance
  - REPO=jazzband/pip-tools
  - REPO=pypa/pipenv
  - REPO=pipxproject/pipx
  - REPO=dabeaz/ply
  - REPO=python/psf-salt
  - REPO=microsoft/Pyjion
  - REPO=kushaldas/pym
  - REPO=facebook/pyre-check
  - REPO=pytest-dev/pytest
  - REPO=pytest-dev/pytest-asyncio
  - REPO=JennyLawrance/python
  - REPO=brettcannon/python-azure-web-app-cookiecutter  # 2017-02-27
  - REPO=palantir/python-language-server
  - REPO=brettcannon/python-launcher  # 2020-03-25
  - REPO=python-modernize/python-modernize
  - REPO=pypa/packaging.python.org
  - REPO=microsoftgraph/python-sample-pagination
  - REPO=microsoft/python-sample-vscode-flask-tutorial
  - REPO=pyvideo/data
  - REPO=rust-lang/rust
  - REPO=regebro/supporting-python-3
  - REPO=python/the-knights-who-say-ni
  - REPO=beeware/toga
  - REPO=python-trio/trio
  - REPO=python/typeshed
  - REPO=python/typing
  - REPO=xmlrunner/unittest-xml-reporting
  - REPO=python-hyper/uritemplate
  - REPO=uri-templates/uritemplate-py
  - REPO=vibora-io/vibora
  - REPO=microsoft/vscode
  - REPO=microsoft/vscode-dev-containers
  - REPO=microsoft/vscode-python
  - REPO=pycascades/welcome-wagon-2018
install:
  #- pip install -r requirements.txt
  - pip install codespell flake8  # pytest  # add other testing frameworks later
before_script:
  - URL=https://github.com/${REPO}
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - git clone --depth=50 ${URL} ~/${REPO}  # --branch=master
  - cd ~/${REPO}
script:
  - echo stop the build if there are Python syntax errors or undefined names
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - time flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
  - echo exit-zero treats all errors as warnings.  The GitHub editor is 127 chars wide
  - flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
  - codespell . --ignore-words-list=ba,referer --skip=./.* --quiet-level=2 || true
  #- true  # pytest --capture=sys
notifications:
  on_success: change
  on_failure: change  # `always` will be the setting once code changes slow down
