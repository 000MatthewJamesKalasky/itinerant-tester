group: travis_latest
dist: xenial  # required for Python >= 3.7 (travis-ci/travis-ci#9069)
language: python
cache: pip
python:
  #- 2.7
  #- 3.5
  #- 3.6
  - 3.7
matrix:
  allow_failures:
    - python: 2.7
    - python: nightly
    - python: pypy
    - python: pypy3
env:
  - REPO=openshift/ansible-service-broker  # 2019-07-08
  - REPO=openshift/aos-cd-jobs        # 2019-07-08
  - REPO=openshift/aws-account-operator  # 2019-07-03
  - REPO=openshift/certman-operator   # 2019-06-28
  - REPO=openshift/cloud-costs        # 2017-04-17
  - REPO=openshift/cloudflare-cfssl   # 2018-03-21 cloudflare/cfssl
  - REPO=cloudflare/cfssl
  - REPO=openshift/cluster-api        # 2019-07-09 kubernetes-sigs/cluster-api
  - REPO=kubernetes-sigs/cluster-api
  - REPO=openshift/cluster-api-provider-azure  # 2019-07-09 kubernetes-sigs/cluster-api-provider-azure
  - REPO=kubernetes-sigs/cluster-api-provider-azure
  - REPO=openshift/cluster-capacity   # 2019-07-07 kubernetes-incubator/cluster-capacity
  - REPO=kubernetes-incubator/cluster-capacity
  - REPO=openshift/cluster-logging-operator  # 2019-07-10
  - REPO=openshift/cluster-monitoring-operator  # 2019-07-04
  - REPO=openshift/cluster-operator   # 2019-05-29
  - REPO=openshift/configure-alertmanager-operator  # 2019-07-02
  - REPO=openshift/deadmanssnitch-operator  # 2019-06-20
  - REPO=openshift/dedicated-admin-operator  # 2019-06-27
  - REPO=openshift/docker-registry-extensions  # 2016-10-11
  - REPO=openshift/etcd-ha-operator   # 2019-05-08
  - REPO=openshift/external-dns       # 2019-05-15
  - REPO=openshift/external-storage   # 2019-05-13 kubernetes-incubator/external-storage
  - REPO=kubernetes-incubator/external-storage
  - REPO=openshift/google-cadvisor    # 2019-06-26 google/cadvisor
  - REPO=google/cadvisor
  - REPO=openshift/google-certificate-transparency  # 2018-03-21 google/certificate-transparency
  - REPO=google/certificate-transparency
  - REPO=openshift/grafana            # 2019-06-28 grafana/grafana
  - REPO=grafana/grafana
  - REPO=openshift/hive               # 2019-07-09
  - REPO=openshift/images             # 2019-05-13
  - REPO=openshift/installer          # 2019-07-10
  - REPO=openshift/ironic             # 2019-06-18 openstack/ironic
  - REPO=openstack/ironic
  - REPO=openshift/ironic-inspector   # 2019-06-18 openstack/ironic-inspector
  - REPO=openstack/ironic-inspector
  - REPO=openshift/ironic-lib         # 2019-06-19 openstack/ironic-lib
  - REPO=openstack/ironic-lib
  - REPO=openshift/ironic-prometheus-exporter  # 2019-06-05 metal3-io/ironic-prometheus-exporter
  - REPO=metal3-io/ironic-prometheus-exporter
  - REPO=openshift/knative-test-infra  # 2018-11-15 knative/test-infra
  - REPO=knative/test-infra
  - REPO=openshift/kubernetes         # 2019-07-09 kubernetes/kubernetes
  - REPO=kubernetes/kubernetes
  - REPO=openshift/kubernetes-api     # 2019-05-16 kubernetes/api
  - REPO=kubernetes/api
  - REPO=openshift/kubernetes-apiextensions-apiserver  # 2019-07-02 kubernetes/apiextensions-apiserver
  - REPO=kubernetes/apiextensions-apiserver
  - REPO=openshift/kubernetes-apimachinery  # 2019-07-05 kubernetes/apimachinery
  - REPO=kubernetes/apimachinery
  - REPO=openshift/kubernetes-apiserver  # 2019-07-05 kubernetes/apiserver
  - REPO=kubernetes/apiserver
  - REPO=openshift/kubernetes-autoscaler  # 2019-07-09 kubernetes/autoscaler
  - REPO=kubernetes/autoscaler
  - REPO=openshift/kubernetes-client-go  # 2019-07-02 kubernetes/client-go
  - REPO=kubernetes/client-go
  - REPO=openshift/kubernetes-code-generator  # 2019-05-13 kubernetes/code-generator
  - REPO=kubernetes/code-generator
  - REPO=openshift/kubernetes-kube-aggregator  # 2019-06-13 kubernetes/kube-aggregator
  - REPO=kubernetes/kube-aggregator
  - REPO=openshift/kubernetes-metrics  # 2019-05-13 kubernetes/metrics
  - REPO=kubernetes/metrics
  - REPO=openshift/kuryr-kubernetes   # 2019-07-10
  - REPO=openshift/library            # 2019-07-03
  - REPO=openshift/managed-cluster-config  # 2019-07-09
  - REPO=openshift/managed-prometheus-exporter-dns  # 2019-06-27
  - REPO=openshift/managed-prometheus-exporter-ebs-iops-reporter  # 2019-06-11
  - REPO=openshift/managed-prometheus-exporter-initcontainer  # 2019-05-21
  - REPO=openshift/managed-prometheus-exporter-machine-api  # 2019-06-24
  - REPO=openshift/managed-prometheus-exporter-stuck-ebs-vols  # 2019-07-09
  - REPO=openshift/node_exporter      # 2019-07-07 prometheus/node_exporter
  - REPO=prometheus/node_exporter
  - REPO=openshift/ocp-release-operator-sdk  # 2019-05-13
  - REPO=openshift/odo                # 2019-07-10
  - REPO=openshift/online-archivist   # 2018-06-24
  - REPO=openshift/oo-index           # 2016-02-15
  - REPO=openshift/openshift-ansible  # 2019-07-10
  - REPO=openshift/openshift-ansible-contrib  # 2019-07-05
  - REPO=openshift/openshift-client-python  # 2019-07-08
  - REPO=openshift/openshift-cns-testdrive  # 2019-07-09
  - REPO=openshift/openshift-controller-manager  # 2019-06-27
  - REPO=openshift/openshift-docs     # 2019-07-10
  - REPO=openshift/openshift-extras   # 2016-11-03
  - REPO=openshift/openshift-restclient-python  # 2019-06-28
  - REPO=openshift/openshift-tools    # 2019-07-08
  - REPO=openshift/origin             # 2019-07-10
  - REPO=openshift/origin-aggregated-logging  # 2019-07-10
  - REPO=openshift/origin-ci-tool     # 2018-11-02
  - REPO=openshift/origin-gce         # 2017-12-20
  - REPO=openshift/origin-metrics     # 2019-04-17
  - REPO=openshift/origin-server      # archived
  - REPO=openshift/osd-operators-registry  # 2019-05-07
  - REPO=openshift/pagerduty-operator  # 2019-07-03
  - REPO=openshift/python-interface   # 2018-10-17
  - REPO=openshift/release            # 2019-07-10
  - REPO=openshift/service-catalog    # 2019-07-09 kubernetes-sigs/service-catalog
  - REPO=kubernetes-sigs/service-catalog
  - REPO=openshift/svt                # 2019-07-02
  - REPO=openshift/telemeter          # 2019-07-09
  - REPO=openshift/test-infra         # 2019-05-07 kubernetes/test-infra
  - REPO=kubernetes/test-infra

install:
  #- pip install -r requirements.txt
  - pip install flake8  # pytest  # add other testing frameworks later
before_script:
  - URL=https://github.com/${REPO}
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - git clone --depth=50 ${URL} ~/${REPO}  # --branch=master
  - cd ~/${REPO}
script:
  - echo stop the build if there are Python syntax errors or undefined names
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - time flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
  - echo exit-zero treats all errors as warnings.  The GitHub editor is 127 chars wide
  - time flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
  #- true  # pytest --capture=sys
notifications:
  on_success: change
  on_failure: change  # `always` will be the setting once code changes slow down
