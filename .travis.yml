group: travis_latest
dist: bionic
language: python
cache: pip
python:
  #- 2.7
  #- 3.5
  #- 3.6
  - 3.7
matrix:
  allow_failures:
    - python: 2.7
    - python: nightly
    - python: pypy
    - python: pypy3
env:
  - REPO=dabeaz/bitey                 # 2017-09-11
  - REPO=dabeaz/cluegen               # 2019-07-18
  - REPO=dabeaz/colonel               # 2016-06-13
  - REPO=dabeaz/concurrencylive       # 2015-04-10
  - REPO=dabeaz/curio                 # 2019-05-30
  - REPO=dabeaz/flail                 # 2018-11-24
  - REPO=dabeaz/llvm-py               # 2012-07-25 llvmpy/llvmpy
  - REPO=llvmpy/llvmpy
  - REPO=dabeaz/llvmlite              # 2017-08-31 numba/llvmlite
  - REPO=numba/llvmlite
  - REPO=dabeaz/me-al                 # 2018-11-24
  - REPO=dabeaz/modulepackage         # 2015-04-07
  - REPO=dabeaz/mu                    # 2018-07-23 mu-editor/mu
  - REPO=mu-editor/mu
  - REPO=dabeaz/ply                   # 2019-05-16
  - REPO=dabeaz/py65                  # 2011-01-30 mnaberez/py65
  - REPO=mnaberez/py65
  - REPO=dabeaz/python-cookbook       # 2019-01-13
  - REPO=dabeaz/pythonprog            # 2017-06-22
  - REPO=dabeaz/raft_jun_2019         # 2019-06-28
  - REPO=dabeaz/redis-py              # 2011-01-15 andymccurdy/redis-py
  - REPO=andymccurdy/redis-py
  - REPO=dabeaz/sly                   # 2019-04-09
  - REPO=dabeaz/thredo                # 2018-08-08
  - REPO=dabeaz/typemap               # 2018-11-24

install:
  #- pip install -r requirements.txt
  - pip install flake8  # pytest  # add other testing frameworks later
before_script:
  - URL=https://github.com/${REPO}
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - git clone --depth=50 ${URL} ~/${REPO}  # --branch=master
  - cd ~/${REPO}
script:
  - echo stop the build if there are Python syntax errors or undefined names
  - echo ; echo -n "flake8 testing of ${URL} on " ; python -V
  - time flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
  - echo exit-zero treats all errors as warnings.  The GitHub editor is 127 chars wide
  - time flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics
  #- true  # pytest --capture=sys
notifications:
  on_success: change
  on_failure: change  # `always` will be the setting once code changes slow down
