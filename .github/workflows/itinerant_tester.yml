name: itinerant_tester
on:
  pull_request:
  push:
  #  branches: [master]
jobs:
  itinerant_tester:
    strategy:
      fail-fast: false
      matrix:
        repo:
          - internetarchive/openlibrary-client
          - nodejs/gyp-next
          - nodejs/node-gyp
          - mavlink/MAVSDK
          - mavlink/MAVSDK-Proto
          - mavlink/MAVSDK-Python
          - mavlink/mavlink-devguide
          - mavlink/mavlink.io
          - boto/s3transfer
          - PX4/px4_ros_com
          # - psf/black  # bandit goes into an infinite loop
          # - Azure/azure-sdk-for-python
          #- ArduPilot/pymavlink
          #- bee-san/pyWhat
          #- codespell-project/codespell
          #- ParthJadhav/Tkinter-Designer
          #- samuelcolvin/pydantic
          #- DataDog/dd-trace-py
          #- DataDog/datadogpy
          #- jd/tenacity
          #- sileht/cotyledon
          #- davidlatwe/montydb
          - aaronbassett/FARM-starter
          - artisan-roaster-scope/artisan
          - jldbc/coffee-quality-database
          - Q42/coffeehack
          - Roastero/Openroast
          - infarm/logicipi
          - farmOS/farmOS.py
          - farmOS/farmOS-aggregator
          #- farmerconnect/farmerconnect-ui
          - jumpserver/jumpserver
          - prompt-toolkit/python-prompt-toolkit
          - hyperledger/aries-rfcs
          - linkedin/greykite
          - maurosoria/dirsearch
          #- HubSpot/hubspot-api-python
          - burnash/gspread
          #- googleworkspace/PyDrive
          #- TadaSoftware/PyNFe
          #- akretion/nfelib
          - njdreikosen/email_listener
          - pallupz/covid-vaccine-booking
          #- micheles/decorator 
          #- pantsbuild/pants
          #- apache/incubator-nuttx
          #- Open-Book-Genome-Project/TheBestBookOn.com
          #- Open-Book-Genome-Project/sequencer 
          #- cyberwizard1001/Sem-4-code
          #- aman-raza/Friends_Hack
          #- dropbox/pyannotate
          #- facebookresearch/TransCoder
          #- cisagov/CHIRP
          #- cedadev/datamad2
          #- sass/libsass-python
          #- ReFirmLabs/binwalk
          #- ipython/ipython
          #-  nodejs/node
          #-  nodejs/node-gyp
          #-  nodejs/gyp-next
          # - wasm3/wasm3
          # - domoticz/domoticz
          #- joyent/javascriptlint
          #- joyent/smartos-live
          # - microsoft/debugpy
          #- osm-by/OpenStreetMap.by
          # - bpython/bpython
          # - Open-Book-Genome-Project/TheBestBookOn.com
          #- signalapp/Signal-Android
          #- signalapp/Signal-Desktop
          #- signalapp/Signal-iOS
          #- signalapp/Signal-Server
          #- google/sentencepiece
          #- bnewbold/fatcat-test-base:focal
          #- ubuntu/microk8s
          #- google/brotli
          #- facebookincubator/xar
          #- rytilahti/python-miio
          #- docker/docker-py
          #- internetarchive/fatcat-scholar
          #- internetarchive/infogami
          #- internetarchive/openlibrary
          #- internetarchive/openlibrary-client
          #- internetarchive/snakebite-py3
          #- internetarchive/wmd
          #- jjjake/internetarchive
          #- mapbox/node-pre-gyp
          #- gdamdam/iagitup
          #- gdamdam/saitan
          #- gdamdam/sumo
          #- gdamdam/rapni
          #- v8/v8
          #- httptoolkit/httptoolkit-server
          # - google/clusterfuzz
          # - google/oss-fuzz
          # - dependabot/dependabot-core
        python-version: [3.9]  # [2.7, 3.5, 3.6, 3.7, 3.8, pypy3]
    runs-on: ubuntu-latest
    steps:
      # - uses: actions/checkout@v2
      - run: git clone https://github.com/${{ matrix.repo }}
      - uses: actions/setup-python@v2
        with:
          python-version: ${{ matrix.python-version }}
      - run: brew --version || true
      - run: pip install bandit black codespell flake8 isort mypy pytest pyupgrade safety
      - run: bandit -r . || true
      - run: black --check . || true
      # - run: black --diff . || true
      # - if: matrix.python-version >= 3.6
      #  run: |
      #    pip install black
      #    black --check . || true
      - run: codespell --quiet-level=2 || true  # --ignore-words-list="" --skip=""
      - run: flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics
      - run: flake8 . --count --exit-zero --max-line-length=88 --show-source --statistics
      - run: isort --profile black . || true
      - run: pip install -r requirements.txt || true
      - run: mypy --install-types --ignore-missing-imports . || true
      - run: pytest . || true
      - run: pytest --doctest-modules . || true
      - run: shopt -s globstar && pyupgrade --py36-plus **/*.py || true
      - run: safety check
